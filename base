import random
import time

# 0 pour pierre, 1 pour feuille, 2 pour ciseaux
authorized_answer: list[int] = ["pierre", "papier", "ciseaux"]

# correspond aux événements, ligne correspond au choix joueurs et colonne celui de l'IA
result: list[list[str]] = \
        [
            ["egalité", "perdu", "gagné"],
            ["gagné", "égalité", "perdu"],
            ["perdu", "gagné", "égalité"],
        ]

# correspond à l'incrémentation du score selon les conditions
matrice_result: list[list[list[int]]] = \
    [
        [[0, 0], [0, 1], [1, 0]],
        [[1, 0], [0, 0], [0, 1]],
        [[0, 1], [1, 0], [0, 0]],
    ]

def askInput(authorized_inputs: list [str]) -> str:
    i: int = 0
    choice: str = input("").casefold()
    while i < len(authorized_inputs):
        if choice == authorized_inputs[i]:
            return choice
        i += 1
        if i == len(authorized_inputs):
            authorized_inputs = "not valid word"
            break

def display_game_status(x,y,z):
    print(f"Manche win joueur : {x}    Manche win IA : {y}")
    print(f"Round {z} :")
    print("\nChoisissez un objet parmis ceux presentés\n")
    print(authorized_answer)

def get_player_choice() -> int:
    while True:
        authorized_choice: str = askInput(authorized_answer)
        if authorized_choice == authorized_answer[0]:
            numPlayer: int = 0
            return numPlayer
        elif authorized_choice == authorized_answer[1]:
            numPlayer: int = 1
            return numPlayer
        elif authorized_choice == authorized_answer[2]:
            numPlayer: int = 2
            return numPlayer

        time.sleep(1.0)
        print("Mot inconnu")


def baseValue() -> tuple[int, int, int, int]:
    maxwin: int = 3
    round: int = 1
    winPlayer: int = 0
    winIA: int = 0
    return maxwin, round, winPlayer, winIA

def retry():
    print('Veux-tu rejouer ?\nEntrez "y" or "n" \n')
    while True:
        again: str = input("")

        if again == "y":
            isBeginning = True
            print("okkkkk")
            return isBeginning
        elif again == 'n':
            isPlayingGame = False
            print('OK THEN, C CIAO!\n\n\n\n')
            break

        print("\nVeuillez entrer Y ou N\n")
def launch_game():
    isPlayingGame: bool = True
    while isPlayingGame:
        maxwin, round, winPlayer, winIA = baseValue()

        while winPlayer < maxwin and winIA < maxwin:
            display_game_status(winPlayer, winIA, round)
            numPlayer: int = get_player_choice()
            numIA: int = random.randint(1, 1)
            winIA = winIA + matrice_result[numPlayer][numIA][1]
            winPlayer += matrice_result[numPlayer][numIA][0]
            print(winPlayer)
            print(winIA)
            print(result[numPlayer][numIA])
            round += 1

        if winPlayer == maxwin:
            print("Bravo tu as gagné !")
        else:
            print("Dommage tu as perdu !")

        isPlayingGame = retry()

launch_game()
